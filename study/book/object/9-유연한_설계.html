<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>유연한 설계 | Lingi-log</title>
    <meta name="description" content="개발 관련 이것 저것">
    
    
    <link rel="preload" href="/assets/css/0.styles.4b6fa609.css" as="style"><link rel="preload" href="/assets/js/app.1c31e98f.js" as="script"><link rel="preload" href="/assets/js/2.e80d00ed.js" as="script"><link rel="preload" href="/assets/js/58.c7ffe1e5.js" as="script"><link rel="prefetch" href="/assets/js/10.68a448a3.js"><link rel="prefetch" href="/assets/js/11.507231df.js"><link rel="prefetch" href="/assets/js/12.b6943770.js"><link rel="prefetch" href="/assets/js/13.ee522674.js"><link rel="prefetch" href="/assets/js/14.9a220730.js"><link rel="prefetch" href="/assets/js/15.fef4c435.js"><link rel="prefetch" href="/assets/js/16.54acc4aa.js"><link rel="prefetch" href="/assets/js/17.224db0f9.js"><link rel="prefetch" href="/assets/js/18.a9bbc120.js"><link rel="prefetch" href="/assets/js/19.d6426c81.js"><link rel="prefetch" href="/assets/js/20.edd774c2.js"><link rel="prefetch" href="/assets/js/21.78fcfee4.js"><link rel="prefetch" href="/assets/js/22.e466e57e.js"><link rel="prefetch" href="/assets/js/23.e35f7e12.js"><link rel="prefetch" href="/assets/js/24.a1258fa9.js"><link rel="prefetch" href="/assets/js/25.684bae30.js"><link rel="prefetch" href="/assets/js/26.45a8eb7a.js"><link rel="prefetch" href="/assets/js/27.b033714f.js"><link rel="prefetch" href="/assets/js/28.f18b24de.js"><link rel="prefetch" href="/assets/js/29.34af3d20.js"><link rel="prefetch" href="/assets/js/3.cb29ebbc.js"><link rel="prefetch" href="/assets/js/30.90507505.js"><link rel="prefetch" href="/assets/js/31.97e4aaf0.js"><link rel="prefetch" href="/assets/js/32.03ad6cf9.js"><link rel="prefetch" href="/assets/js/33.65896623.js"><link rel="prefetch" href="/assets/js/34.d5128d79.js"><link rel="prefetch" href="/assets/js/35.4e3704cd.js"><link rel="prefetch" href="/assets/js/36.48919dbb.js"><link rel="prefetch" href="/assets/js/37.351a5c91.js"><link rel="prefetch" href="/assets/js/38.494bbd4b.js"><link rel="prefetch" href="/assets/js/39.4a1db78e.js"><link rel="prefetch" href="/assets/js/4.72798ad3.js"><link rel="prefetch" href="/assets/js/40.62339fe0.js"><link rel="prefetch" href="/assets/js/41.ab3e1d4a.js"><link rel="prefetch" href="/assets/js/42.242ebb30.js"><link rel="prefetch" href="/assets/js/43.d5512060.js"><link rel="prefetch" href="/assets/js/44.501eab8c.js"><link rel="prefetch" href="/assets/js/45.de191923.js"><link rel="prefetch" href="/assets/js/46.1220e44b.js"><link rel="prefetch" href="/assets/js/47.041ebc8d.js"><link rel="prefetch" href="/assets/js/48.e3343f24.js"><link rel="prefetch" href="/assets/js/49.843ce035.js"><link rel="prefetch" href="/assets/js/5.02e5115b.js"><link rel="prefetch" href="/assets/js/50.89b71265.js"><link rel="prefetch" href="/assets/js/51.077bdbb1.js"><link rel="prefetch" href="/assets/js/52.b711c9d4.js"><link rel="prefetch" href="/assets/js/53.10cd30d3.js"><link rel="prefetch" href="/assets/js/54.955448cd.js"><link rel="prefetch" href="/assets/js/55.fe2e427d.js"><link rel="prefetch" href="/assets/js/56.2bee3769.js"><link rel="prefetch" href="/assets/js/57.d85872e3.js"><link rel="prefetch" href="/assets/js/59.4d5307df.js"><link rel="prefetch" href="/assets/js/6.14e22481.js"><link rel="prefetch" href="/assets/js/60.db7cf931.js"><link rel="prefetch" href="/assets/js/61.33f53309.js"><link rel="prefetch" href="/assets/js/62.be1b8c82.js"><link rel="prefetch" href="/assets/js/63.df9a7acb.js"><link rel="prefetch" href="/assets/js/64.f8bbfb82.js"><link rel="prefetch" href="/assets/js/65.843daea1.js"><link rel="prefetch" href="/assets/js/66.2425f721.js"><link rel="prefetch" href="/assets/js/67.fae55797.js"><link rel="prefetch" href="/assets/js/68.67875ff9.js"><link rel="prefetch" href="/assets/js/7.bce0ceb8.js"><link rel="prefetch" href="/assets/js/8.3fc9eb92.js"><link rel="prefetch" href="/assets/js/9.c8f578bf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4b6fa609.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/thumbnail.png" alt="Lingi-log" class="logo"> <span class="site-name can-hide">Lingi-log</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="/backend/" class="nav-link">Backend</a></div><div class="nav-item"><a href="/frontend/" class="nav-link">Frontend</a></div><div class="nav-item"><a href="/linux/" class="nav-link">Linux</a></div><div class="nav-item"><a href="/db/" class="nav-link">DB</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="/backend/" class="nav-link">Backend</a></div><div class="nav-item"><a href="/frontend/" class="nav-link">Frontend</a></div><div class="nav-item"><a href="/linux/" class="nav-link">Linux</a></div><div class="nav-item"><a href="/db/" class="nav-link">DB</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Design Pattern</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/designpattern/1_observer.html" class="sidebar-link">Observer Pattern</a></li><li><a href="/study/designpattern/2_proxy.html" class="sidebar-link">Proxy Pattern</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Algorithm</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Leet Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/algorithm/algorithm_leet_46-50.html" class="sidebar-link">46번 ~ 50번</a></li><li><a href="/study/algorithm/algorithm_leet_51-60.html" class="sidebar-link">51번 ~ 60번</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>깨끗한 코드</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/refactoring/1_intro.html" class="sidebar-link">INTRO</a></li><li><a href="/study/refactoring/2_목표설명.html" class="sidebar-link">목표 설명</a></li><li><a href="/study/refactoring/3_적용.html" class="sidebar-link">적용 사례</a></li><li><a href="/study/refactoring/4_적용2.html" class="sidebar-link">적용 사례 2</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>책</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>오브젝트</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/book/object/2-객체지향프로그래밍.html" class="sidebar-link">2. 객체지향 프로그래밍</a></li><li><a href="/study/book/object/3-역할_책임_협력.html" class="sidebar-link">3. 역할, 책임, 협력</a></li><li><a href="/study/book/object/4-설계_품질과_트레이드오프.html" class="sidebar-link">4. 설계 품질과 트레이드오프</a></li><li><a href="/study/book/object/5-책임_할당하기.html" class="sidebar-link">5. 책임 할당하기</a></li><li><a href="/study/book/object/6-메시지와_인터페이스.html" class="sidebar-link">6. 메시지와 인터페이스</a></li><li><a href="/study/book/object/7-객체_분해.html" class="sidebar-link">7. 객체 분해</a></li><li><a href="/study/book/object/8-의존성_관리하기.html" class="sidebar-link">8. 의존성 관리하기</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="유연한-설계">유연한 설계</h1> <h2 id="_01-개방-폐쇄-원칙">01. 개방 폐쇄 원칙</h2> <p>소프트웨어 개체(클래스, 모듈, 함수)는 확장에 대해 열려 있어야 하고, 수정에 대해서는 닫혀 있어야 한다. 여기서 확장과 수정이라는 키워드는 애플리케이션의 '동작'과 '코드'의 관점을 반영한다. 해석해보면</p> <ul><li>확장에 대해 열려있다 : 애플리케이션의 요구사항이 변경될 때 이 변경에 맞게 새로운 '동작'을 추가해서 애플리케이션의 기능을 확장할 수 있다.</li> <li>수정에 대해 닫혀있다 : 기존의 '코드'를 수정하지 않고도 애플리케이션의 동작을 추가하거나 변경할 수 있다.</li></ul> <p>달리 말하면 컴파일 타임 의존성을 수정 하지 않고 런타임 의존성을 변경할 수 있다는 말이다.</p> <h3 id="추상화가-핵심이다">추상화가 핵심이다.</h3> <p>개방-폐쇄 원칙의 핵심은 추상화에 의존하는 것이다. 추상화를 하면 핵심적인 부분은 남기고 불필요한 부분은 생략하게 된다. 생략된 부분은 문맥에 따라 적절하게 채워넣음으로써 문맥에 맞게 적합하게 기능을 구체화하고 확장할 수 있다.</p> <p>추상화 해서 남아있는 부분은 문맥이 변해도 달라지지 않는다(수정에 닫혀있다). 그리고 생략된 부분은 문맥에 따라 확장의 여지를 남긴다. 이것이 추상화가 개방-폐쇄 원칙을 가능하게 만드는 이유이다.</p> <h2 id="_02-생성-사용-분리">02. 생성 사용 분리.</h2> <p>한 객체가 추상화된 객체에만 의존하기 위해선 객체 내부에서 구체 클래스의 인스턴스를 생성해선 안된다. 결합도가 높아지기 때문이다. 결합도가 높아질수록 개방-폐쇄원칙을 따르는 구조를 설계하기가 힘들어진다. 하지만 어디에선가는 객체 생성을 해줘야 한다. 객체를 사용하는 Client에게 구체 인스턴스 생성의 책임을 맡기는 것이 한 가지 해결책이다.</p> <p><img src="" alt="그림9.5"></p> <p>Movie의 의존성을 추상화인 DiscountPolicy로만 제한하기 때문에 확장에 대해선 열려있고 수정엔 닫혀있는 코드를 만들 수 있다.</p> <h3 id="factory-추가하기">Factory 추가하기</h3> <p>생성 책임을 Client로 옮긴 배경에느 Movie는 특정 컨텍스트에 묶여서는 안되지만 Client는 묶여도 상간이 없다는 전제가 깔려잇다. 하지만 이렇게 되면 Client 코드도 객체 생성과 사용 책임을 함께 지니게 된다.</p> <p>이 경우 객체 생성에 대한 책임만 전담하는 별도의 객체를 추가하고 Client는 이 객체를 사용하도록 만들 수 있다. 이런 생성에 특화된 객체를 Factory라고 한다.</p> <p><img src="" alt="그림9.6"></p> <p>위와같이 Factory객체를 사용한다면 Client는 오직 사용과 관련된 책임만 지고 생성과 관련해서는 어떤 지식도 가지지 않을 수 있다.</p> <h2 id="_03-의존성-주입">03. 의존성 주입</h2> <p>사용하는 객체가 아닌 외부의 독립적인 객체가 인스턴스를 생성 후 이를 전달해서 의존성을 해결하는 방법을 <strong>의존성 주입</strong>이라 부른다.</p> <p>의존성 주입에는 세 가지 방법이 있다.</p> <ul><li>생성자 주입 : 객체를 생성하는 시점에 생성자를 통한 의존성 해결</li> <li>setter 주입 : 객체 생성 후 setter 메서드를 통한 의존성 해결</li> <li>메서드 주입 : 메서드 실행 시 인자를 이용한 의존성 해결</li></ul> <p>상황에 따라서 적절한 방법을 혼합하여 사용하면 된다.</p> <h3 id="숨겨진-의존성은-나쁘다">숨겨진 의존성은 나쁘다.</h3> <p>의존성 주입 외에도 의존성을 해결할 수 있는 방법으로 <strong>SERVICE LOCATOR</strong> 패턴이 있다. SERVICE LOCATOR에게 의존성을 해결해 달라고 요청하는 것이다. 예를 들면 아래 코드와 같다.
Movie 클래스</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Movie</span><span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscountPolicy</span> discountPolicy<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">DUration</span> runningTime<span class="token punctuation">,</span> <span class="token class-name">Money</span> fee<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>runningTime <span class="token operator">=</span> runningTime<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fee <span class="token operator">=</span> fee<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>discountPolicy <span class="token operator">=</span> discountPolicy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ServiceLocator 클래스</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceLocator</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ServiceLocator</span> soleInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServiceLocator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscountPolicy</span> discountPolicy<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DiscountPolicy</span> <span class="token function">discountPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> soleInstance<span class="token punctuation">.</span>discountPolicy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">provide</span><span class="token punctuation">(</span><span class="token class-name">DiscountPolicy</span> discountPolicy<span class="token punctuation">)</span><span class="token punctuation">{</span>
        soleInstance<span class="token punctuation">.</span>discountPolicy <span class="token operator">=</span> discountPolicy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ServiceLocator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">DUration</span> runningTime<span class="token punctuation">,</span> <span class="token class-name">Money</span> fee<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>runningTime <span class="token operator">=</span> runningTime<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fee <span class="token operator">=</span> fee<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>사용</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ServiceLocator</span><span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AmountDiscountPolicy</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Movie</span> avatar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token string">&quot;아바타&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Money</span><span class="token punctuation">.</span><span class="token function">wons</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>사용 예시를 보면 의존성을 해결할 수 있는 좋은 방법 처럼 보인다. 하지만 의존성을 감춘다는 측면에서 문제가 생길 수 있다. Movie의 퍼블릭 인터페이스 어디에도 의존성에 대한 정보가 표시되어 있지 않다. 의존성이 숨겨져 있으면 의존성을 이해하기 위해 코드 내부 구현을 이해해야하는 문제가 있다. 따라서 캡슐화를 위반하게 된다.</p> <p>하고자 하는 이야기는 가급적 의존성을 객체의 퍼블릭 인터페이스에 노출하는 것이 좋지만 어쩔 수 없는 경우(의존성 주입해주는 프레임워크 사용 X, 깊은 호출 계층에 걸쳐 동일한 객체를 계속해서 전달해야 하는 경우) SERVICE LOCATOR 사용을 고려하는 것이 좋다는 것이다.</p> <h2 id="_04-의존성-역전-원칙">04. 의존성 역전 원칙</h2> <h3 id="추상화와-의존성-역전-원칙">추상화와 의존성 역전 원칙</h3> <p>의존성 역전 원칙을 설명하면</p> <ul><li>상위수준 모듈은 하위수준 모듈에 의존해서는 안 된다. 둘 다 추상화에 의존해야 한다.</li> <li>추상화는 구체적인 사항에 의존해서는 안 된다. 구체적인 사항은 추상화에 의존해야 한다.</li></ul> <p>여기서 <em>역전</em> 이란 말이 사용된 이유는 이 원칙이 전통적인 절차형 프로그래밍과 의존성의 방향이 반대로 나타나기 때문이다.</p> <p>상위수준이란 객체사이의 협력이 존재할 때 그 협력의 본질을 담고있는 것이다. 상위수준의 클래스가 하위수준의 클래스에 의존하게 되면 상위수준 클래스를 재사용할때 하위수준 클래스도 필요하게 되므로 재사용하기 어려워 진다. 또한 하위수준의 변경으로 인해 상위수준까지 변경이 가능성을 가지게 된다.</p> <p>이럴 때 추상화를 사용해 상위수준에 의존을 하게 만들어야 한다. 구체 클래스는 의존의 시작점이어야 한다. 의존성의 목적지가 되면 안 된다.</p> <h2 id="_05-유연성에-대한-조언">05. 유연성에 대한 조언</h2> <h3 id="유연한-설계는-유연성이-필여할-때만-옳다">유연한 설계는 유연성이 필여할 때만 옳다.</h3> <p>유연하고 재사용 가능한 설계가 항상 옳은것은 아니다. 설계의 미덕은 단순함과 명확함에서 나오는데, 유연한 설계라는 말의 이면에는 복잡한 설계라는 의미가 숨어있다. 불필요한 유연성은 불필요한 복잡성을 낳는다. 단순하고 명확한 해법이 그런대로 만족스럽다면 유연성을 제거해라. 유연성은 코드를 읽는 사람이 복잡성을 수용할 수 있을때만 가치가 있다.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/10/2019, 12:47:08 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1c31e98f.js" defer></script><script src="/assets/js/2.e80d00ed.js" defer></script><script src="/assets/js/58.c7ffe1e5.js" defer></script>
  </body>
</html>
